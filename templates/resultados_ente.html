{% extends "base.html" %}
{% block title %}SASP - Resultados por Ente{% endblock %}

{% block content %}
<div class="container resultados-ente">

  <header class="page-header">
    <h2>Resultados del Ente: <span class="ente-nombre">{{ ente }}</span></h2>
    <p class="subtitle">Trabajadores con registros laborales detectados en este ente y sus quincenas activas.</p>
  </header>

  {% if resultados_agrupados %}
    {% for rfc, info in resultados_agrupados.items() %}
    <article class="result-card">
      <header class="result-header">
        <div>
          <h3><a href="{{ url_for('resultados_por_rfc', rfc=rfc) }}">{{ rfc }}</a></h3>
          <p class="result-nombre">{{ info.nombre or 'Sin nombre' }}</p>
        </div>
      </header>

      {% if info.registros %}
      <table class="detalle-tabla">
        <thead>
          <tr>
            <th>Puesto</th>
            <th>Fecha Alta</th>
            <th>Fecha Baja</th>
            <th>Monto (MXN)</th>
            <th>Quincenas Activas</th>
          </tr>
        </thead>
        <tbody>
          {% for reg in info.registros %}
          <tr>
            <td>{{ reg.puesto or '‚Äî' }}</td>
            <td>{{ reg.fecha_ingreso or '‚Äî' }}</td>
            <td>{{ reg.fecha_egreso or '‚Äî' }}</td>
            <td>{{ reg.monto or '‚Äî' }}</td>
            <td>
              {% if reg.qnas %}
                <span class="qna-badge">{{ reg.qnas }}</span>
              {% else %}
                ‚Äî
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% endif %}
    </article>
    {% endfor %}
  {% else %}
    <section class="empty-state">
      <div class="empty-icon">üèõÔ∏è</div>
      <h3>No hay registros asociados a este ente</h3>
    </section>
  {% endif %}
</div>
{% endblock %}

