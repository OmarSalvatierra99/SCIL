{% extends "base.html" %}
{% block title %}Solventaci√≥n de Caso{% endblock %}

{% block content %}
<div class="solventacion-container">
  <header class="header-flex">
    <h2>Solventaci√≥n de Posible Duplicidad</h2>
    <span class="subtitle">Actualiza el estado de la revisi√≥n</span>
  </header>

  <div class="info-rfc">
    <p><strong>RFC:</strong> {{ rfc }}</p>
    <p><strong>Nombre:</strong> {{ info.nombre or 'Sin nombre' }}</p>
  </div>

  <form id="solventacionForm"
        method="post"
        action="{{ url_for('solventacion_detalle', rfc=rfc) }}?ente={{ request.args.get('ente') }}"
        data-rfc="{{ rfc }}">
    <!-- Captura el ente pasado en la URL -->
    <input type="hidden" name="ente" value="{{ request.args.get('ente') or info.entes[0] }}">

    <div class="form-group">
      <label for="estado">Estado de valoraci√≥n:</label>
      <select id="estado" name="estado" required>
        <option value="">Selecciona estado...</option>
        <option value="Solventado" {% if info.estado == 'Solventado' %}selected{% endif %}>Solventado</option>
        <option value="No Solventado" {% if info.estado == 'No Solventado' %}selected{% endif %}>No Solventado</option>
        <option value="Sin valoraci√≥n" {% if info.estado == 'Sin valoraci√≥n' %}selected{% endif %}>Sin valoraci√≥n</option>
      </select>
    </div>

    <div class="form-group">
      <label for="comentario">Comentarios o justificaci√≥n:</label>
      <textarea id="solventacion" name="comentario" rows="4"
        placeholder="Describe brevemente la raz√≥n de la solventaci√≥n...">{{ info.solventacion or '' }}</textarea>
    </div>

    <div class="btn-area">
      <button type="submit" class="btn btn-primary">üíæ Guardar cambios</button>
      <a href="{{ url_for('resultados_por_rfc', rfc=rfc) }}" class="btn btn-secondary">‚Üê Regresar</a>
    </div>

    <p id="confirmacion" class="confirmacion"></p>
  </form>
</div>
{% endblock %}

