{% extends "base.html" %}
{% block title %}SASP - Resultados Laborales{% endblock %}

{% block content %}
<div class="container">
  <div class="page-header">
    <h2>Resultados de AuditorÃ­a Laboral</h2>
    <p>Trabajadores con cruces detectados entre entes por quincena.</p>
  </div>

  <div class="search-section">
    <div class="search-box-minimal">
      <input type="text" id="searchInput" placeholder="Buscar por RFC o nombre..." value="{{ busqueda }}">
      <button onclick="filterResults()" class="btn btn-primary">Buscar</button>
    </div>
    <div class="export-minimal">
      <a href="/exportar/laboral" class="btn btn-secondary">Exportar Excel</a>
    </div>
  </div>

  {% if resultados_agrupados %}
    {% for rfc, info in resultados_agrupados.items() %}
    <div class="result-minimal-card">
      <div class="result-minimal-header">
        <div>
          <h3>{{ rfc }}</h3>
          <p style="color:var(--color-muted);">{{ info.nombre }}</p>
        </div>
      </div>

      <div>
        <strong style="color:var(--color-primary);">Entes involucrados:</strong>
        {% for e in info.entes %}
          <span class="ente-tag">{{ e }}</span>
        {% endfor %}
      </div>

      {% if info.registros %}
      <table class="detalle-tabla">
        <thead>
          <tr>
            <th>Ente</th>
            <th>Puesto</th>
            <th>Fecha Alta</th>
            <th>Fecha Baja</th>
            <th>Monto</th>
          </tr>
        </thead>
        <tbody>
          {% for reg in info.registros %}
          <tr>
            <td>{{ reg.ente }}</td>
            <td>{{ reg.puesto }}</td>
            <td>{{ reg.fecha_ingreso or 'â€”' }}</td>
            <td>{{ reg.fecha_egreso or 'â€”' }}</td>
            <td>{{ reg.monto or 'â€”' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% endif %}
    </div>
    {% endfor %}
  {% else %}
    <div class="empty-state-minimal">
      <div class="empty-icon">ðŸ“­</div>
      <h3>No se encontraron resultados</h3>
    </div>
  {% endif %}
</div>
{% endblock %}

